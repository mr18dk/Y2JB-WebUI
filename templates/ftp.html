<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FTP Manager - Y2JB</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        oled: { base: '#000000', surface: '#121212', border: '#2a2a2a' },
                        brand: { blue: '#00439c', light: '#0070d1' }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style/index.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style/ftp.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style/toast.css') }}">
    <script src="{{ url_for('static', filename='color_mode.js') }}" defer></script>
    <script src="{{ url_for('static', filename='toast.js') }}" defer></script>
</head>

<body class="font-sans antialiased min-h-screen flex flex-col bg-oled-base text-white">

    <nav class="w-full border-b surface/90 backdrop-blur-md border-white/5 sticky top-0 z-30">
        <div class="mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <a href="/" class="flex items-center gap-2 opacity-80 hover:opacity-100 transition-opacity">
                    <i class="fa-solid fa-arrow-left"></i>
                    <span class="font-bold text-lg">FTP Manager</span>
                </a>
            </div>
            <div id="connection-status" class="text-xs uppercase tracking-wider opacity-50 font-mono">
                Disconnected
            </div>
        </div>
    </nav>

    <main class="flex-1 w-full max-w-6xl mx-auto px-4 py-6 space-y-4">
        
        <div class="flex flex-col md:flex-row gap-4 justify-between items-center surface border rounded-xl p-3">
            <div class="flex items-center gap-2 w-full md:w-auto overflow-hidden">
                <button onclick="navigateUp()" class="p-2 hover:bg-white/5 rounded-lg transition-colors">
                    <i class="fa-solid fa-level-up-alt"></i>
                </button>
                <div id="breadcrumbs" class="flex-1 font-mono text-sm overflow-x-auto whitespace-nowrap scrollbar-hide px-2">
                    /
                </div>
            </div>
            
            <div class="flex items-center gap-2 w-full md:w-auto">
                <button onclick="refreshDir()" class="btn-tool" title="Refresh">
                    <i class="fa-solid fa-rotate-right"></i>
                </button>
                <button onclick="createFolder()" class="btn-tool" title="New Folder">
                    <i class="fa-solid fa-folder-plus"></i>
                </button>
                <button onclick="createFile()" class="btn-tool" title="New File">
                    <i class="fa-solid fa-file-circle-plus"></i>
                </button>
                <button onclick="document.getElementById('upload-input').click()" class="btn-tool" title="Upload File">
                    <i class="fa-solid fa-upload"></i>
                </button>
                <input type="file" id="upload-input" class="hidden" onchange="handleUpload(this)">
            </div>
        </div>

        <div class="surface border rounded-xl overflow-hidden min-h-[500px] flex flex-col relative">
            <div id="loader" class="absolute inset-0 bg-oled-surface/80 z-20 flex items-center justify-center hidden">
                <i class="fa-solid fa-circle-notch fa-spin text-3xl text-brand-light"></i>
            </div>

            <div class="grid grid-cols-12 gap-4 p-3 border-b border-white/5 text-xs font-bold opacity-50 uppercase tracking-wider">
                <div class="col-span-1">Type</div>
                <div class="col-span-7 md:col-span-6">Name</div>
                <div class="col-span-2 hidden md:block text-right">Size</div>
                <div class="col-span-4 md:col-span-3 text-right">Actions</div>
            </div>
            
            <div id="file-list" class="flex-1 overflow-y-auto custom-scroll">
                </div>
        </div>

    </main>

    <div id="editor-modal" class="fixed inset-0 z-50 hidden bg-black/80 backdrop-blur-sm items-center justify-center p-4">
        <div class="surface border rounded-xl w-full max-w-4xl h-[80vh] flex flex-col shadow-2xl">
            <div class="flex items-center justify-between p-4 border-b border-white/5">
                <h3 class="font-bold flex items-center gap-2">
                    <i class="fa-solid fa-pen-to-square text-brand-light"></i>
                    <span id="editor-filename">filename.txt</span>
                </h3>
                <button onclick="closeEditor()" class="text-white/50 hover:text-white"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            <textarea id="editor-content" class="flex-1 bg-oled-base p-4 font-mono text-sm outline-none resize-none"></textarea>
            <div class="p-4 border-t border-white/5 flex justify-end gap-3">
                <button onclick="closeEditor()" class="px-4 py-2 rounded-lg border border-white/10 hover:bg-white/5 text-sm">Cancel</button>
                <button onclick="saveEditorContent()" class="px-4 py-2 rounded-lg bg-brand-blue hover:bg-brand-light text-white text-sm font-bold">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="image-modal" class="fixed inset-0 z-50 hidden bg-black/95 backdrop-blur-md items-center justify-center p-4" onclick="closeImageViewer()">
        <div class="relative flex flex-col items-center" onclick="event.stopPropagation()">
            <img id="image-viewer-target" src="" class="max-w-[90vw] max-h-[80vh] rounded-lg shadow-2xl border border-white/10 object-contain">
            <div class="mt-4 px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/5 flex items-center gap-3">
                <span id="image-viewer-filename" class="text-sm font-mono text-white/90">image.png</span>
                <div class="w-px h-4 bg-white/20"></div>
                <a id="image-viewer-download" href="#" download class="text-xs text-brand-light hover:text-white uppercase font-bold tracking-wider transition-colors">
                    Download
                </a>
            </div>
            <button onclick="closeImageViewer()" class="absolute -top-12 right-0 md:-right-12 text-white/50 hover:text-white transition-colors p-2">
                <i class="fa-solid fa-xmark text-2xl"></i>
            </button>
        </div>
    </div>

    <script src="{{ url_for('static', filename='ftp.js') }}"></script>
</body>
</html>